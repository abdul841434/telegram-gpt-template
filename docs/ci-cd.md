# üöÄ CI/CD: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ Yandex Cloud

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä Yandex Cloud –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `main`.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏](#—á—Ç–æ-–ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex Cloud](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-yandex-cloud)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-github-secrets)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞)
- [–ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π](#–ø–µ—Ä–≤—ã–π-–¥–µ–ø–ª–æ–π)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏)
- [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü—Ä–∏ –∫–∞–∂–¥–æ–º `git push` –≤ –≤–µ—Ç–∫—É `main`:

1. ‚úÖ **–¢–µ—Å—Ç—ã** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Python –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON
2. üèóÔ∏è **–°–±–æ—Ä–∫–∞** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ Docker –æ–±—Ä–∞–∑–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤ Yandex Container Registry
3. üöÄ **–î–µ–ø–ª–æ–π** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
4. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è

–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç **3-5 –º–∏–Ω—É—Ç**.

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –í Yandex Cloud:

- ‚òÅÔ∏è –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Yandex Cloud
- üí≥ –ü—Ä–∏–≤—è–∑–∞–Ω–Ω–∞—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –≥—Ä–∞–Ω—Ç)
- üñ•Ô∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ (–º–∏–Ω–∏–º—É–º 1 vCPU, 2 GB RAM)
- üê≥ Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ VM

### –í GitHub:

- üì¶ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞ telegram-gpt
- üîë –ü—Ä–∞–≤–∞ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ Secrets –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex Cloud

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Container Registry

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–µ—Å—Ç—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
yc container registry create --name telegram-gpt-registry

# –ü–æ–ª—É—á–∏—Ç–µ ID —Ä–µ–µ—Å—Ç—Ä–∞
yc container registry list
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ **Registry ID** (–≤–∏–¥–∞ `crp123abc456def`).

### 2. –°–æ–∑–¥–∞–Ω–∏–µ Service Account

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
yc iam service-account create --name github-actions-sa

# –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª–∏
SA_ID=$(yc iam service-account get github-actions-sa --format json | jq -r .id)
REGISTRY_ID="–≤–∞—à_registry_id"

yc container registry add-access-binding \
  --id $REGISTRY_ID \
  --service-account-id $SA_ID \
  --role container-registry.images.pusher

# –°–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
yc iam key create \
  --service-account-id $SA_ID \
  --output key.json
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `key.json` ‚Äî –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è GitHub Secrets.

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Cloud –∏ Folder ID

```bash
# Cloud ID
yc config list | grep cloud-id

# Folder ID
yc config list | grep folder-id
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

```bash
# –°–æ–∑–¥–∞–π—Ç–µ VM —Å Docker
yc compute instance create \
  --name telegram-gpt-server \
  --zone ru-central1-a \
  --network-interface subnet-name=default-ru-central1-a,nat-ip-version=ipv4 \
  --create-boot-disk image-folder-id=standard-images,image-family=ubuntu-2204-lts,size=20 \
  --memory 2 \
  --cores 2 \
  --ssh-key ~/.ssh/id_rsa.pub

# –ü–æ–ª—É—á–∏—Ç–µ IP –∞–¥—Ä–µ—Å
yc compute instance get telegram-gpt-server --format json | jq -r .network_interfaces[0].primary_v4_address.one_to_one_nat.address
```

### 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh ubuntu@<your_server_ip>

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker
sudo apt-get update
sudo apt-get install -y docker.io docker-compose
sudo systemctl enable docker
sudo systemctl start docker
sudo usermod -aG docker $USER

# –ü–µ—Ä–µ–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
exit
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions** ‚Üí **New repository secret**

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ Secrets:

| Secret | –û–ø–∏—Å–∞–Ω–∏–µ | –ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å |
|--------|----------|--------------|
| `YC_SA_JSON_CREDENTIALS` | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ `key.json` | –í–µ—Å—å JSON –∏–∑ —Ñ–∞–π–ª–∞ `key.json` |
| `YC_REGISTRY_ID` | ID Container Registry | `yc container registry list` |
| `YC_CLOUD_ID` | ID –æ–±–ª–∞–∫–∞ | `yc config list` |
| `YC_FOLDER_ID` | ID –∫–∞—Ç–∞–ª–æ–≥–∞ | `yc config list` |
| `YC_INSTANCE_IP` | **–ü—É–±–ª–∏—á–Ω—ã–π** IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ | `yc compute instance get <name>` (–ø–æ–ª–µ `one_to_one_nat.address`) |
| `YC_INSTANCE_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | –î–ª—è YC –æ–±—ã—á–Ω–æ `yc-user` –∏–ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö |
| `SSH_PRIVATE_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á | –§–∞–π–ª –∏–∑ `~/.ssh/` (–Ω–∞–ø—Ä–∏–º–µ—Ä `yc-organization-id-...-<user>`) |
| `TG_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | @BotFather |
| `LLM_TOKEN` | –¢–æ–∫–µ–Ω OpenRouter | https://openrouter.ai/ |
| `ADMIN_CHAT` | ID —á–∞—Ç–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è | @userinfobot |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ Secrets (–µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):

| Secret | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------------|----------|
| `MODEL` | `google/gemini-2.0-flash-exp:free` | –ú–æ–¥–µ–ª—å LLM |
| `MAX_CONTEXT` | `20` | –†–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –º–æ–¥–µ–ª–∏ |
| `MAX_STORAGE` | `100` | –†–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î |
| `FEEDBACK_FORM_URL` | `` (–ø—É—Å—Ç–æ) | –°—Å—ã–ª–∫–∞ –Ω–∞ Google —Ñ–æ—Ä–º—É –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ |

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
sudo mkdir -p /opt/telegram-gpt/data /opt/telegram-gpt/logs
sudo chmod -R 755 /opt/telegram-gpt
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ sudo

–£–∂–µ —Å–¥–µ–ª–∞–Ω–æ –Ω–∞ —à–∞–≥–µ 5 –≤—ã—à–µ, –Ω–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:

```bash
sudo usermod -aG docker $USER
newgrp docker
```

---

## –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ workflow —Ñ–∞–π–ª

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.github/workflows/deploy.yml` –µ—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

### 2. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ Secrets

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ GitHub.

### 3. –°–¥–µ–ª–∞–π—Ç–µ push

```bash
git add .
git commit -m "Setup CI/CD for Yandex Cloud"
git push origin main
```

### 4. –û—Ç—Å–ª–µ–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** –Ω–∞ GitHub
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π workflow run
3. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —ç—Ç–∞–ø–æ–≤:
   - ‚úÖ Test
   - ‚úÖ Build and push
   - ‚úÖ Deploy

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh ubuntu@<your_server_ip>

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker ps | grep telegram-gpt

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker logs telegram-gpt

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
# –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –≤ Telegram
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
docker logs --tail 50 telegram-gpt

# –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker logs -f telegram-gpt

# –õ–æ–≥–∏ –∏–∑ —Ñ–∞–π–ª–∞
ssh ubuntu@<your_server_ip> 'cat /opt/telegram-gpt/logs/debug.log | tail -50'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker ps -a | grep telegram-gpt

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats telegram-gpt

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker inspect telegram-gpt
```

### GitHub Actions –ª–æ–≥–∏

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ workflow run
2. –†–∞—Å–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π step –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ **"Download log archive"**

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Build failed

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ Docker –æ–±—Ä–∞–∑–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤ `Dockerfile`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –µ—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ GitHub Actions

### Push to registry failed

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —É–¥–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—Ä–∞–∑ –≤ Registry

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `YC_SA_JSON_CREDENTIALS` ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π JSON
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `YC_REGISTRY_ID`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É Service Account –µ—Å—Ç—å –ø—Ä–∞–≤–∞ `container-registry.images.pusher`

### Deployment failed - SSH connection

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `YC_INSTANCE_IP` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ IP
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `SSH_PRIVATE_KEY` ‚Äî –≤–µ—Å—å –∫–ª—é—á, –≤–∫–ª—é—á–∞—è `-----BEGIN` –∏ `-----END`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ä–∞–∑—Ä–µ—à–µ–Ω SSH –¥–æ—Å—Ç—É–ø:
   ```bash
   yc compute instance add-one-to-one-nat <instance-name> --network-interface-index 0
   ```

### Container –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `docker logs telegram-gpt`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ Secrets ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ `TG_TOKEN` –∏ `LLM_TOKEN`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã: `ls -la /opt/telegram-gpt/`

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –±–æ—Ç –º–æ–ª—á–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞: `docker logs telegram-gpt`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TG_TOKEN` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ —Ç–æ–∫–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `LLM_TOKEN` –∏ –±–∞–ª–∞–Ω—Å –Ω–∞ OpenRouter
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
   ```bash
   docker exec telegram-gpt env | grep -E 'TG_TOKEN|LLM_TOKEN'
   ```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Ç–µ—Ä—è–Ω–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ë–∞–∑–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ volume `/opt/telegram-gpt/data`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ deploy.sh –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω volume:
  ```bash
  -v /opt/telegram-gpt/data:/data
  ```

### Workflow –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** Workflow –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—Ö, –Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —à–∞–≥–µ "Deploy to Yandex Cloud"
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `sudo usermod -aG docker ubuntu`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Docker —Ä–∞–±–æ—Ç–∞–µ—Ç: `systemctl status docker`

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ GitHub Actions

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ push –≤ `main`:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Actions** –Ω–∞ GitHub
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π workflow run
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
   - ‚úÖ Test - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–º
   - ‚úÖ Build and push - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–º
   - ‚úÖ Deploy - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker ps | grep telegram-gpt

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker logs --tail=50 telegram-gpt

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats telegram-gpt --no-stream
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞

- –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –≤ Telegram
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –∫–æ–º–∞–Ω–¥ `/start`, `/help`

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –¥–µ–ø–ª–æ—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Telegram —á–∞—Ç `ADMIN_CHAT`:
- ‚úÖ –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –¥–µ–ø–ª–æ–µ
- ‚ùå –ü—Ä–∏ –æ—à–∏–±–∫–µ –¥–µ–ø–ª–æ—è

---

## –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π:

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh ubuntu@<your_server_ip>

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker stop telegram-gpt
docker rm telegram-gpt

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—Ä–∞–∑—ã
docker images | grep telegram-gpt

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é
docker run -d \
  --name telegram-gpt \
  --restart unless-stopped \
  --env-file /opt/telegram-gpt/.env \
  -v /opt/telegram-gpt/data:/data \
  cr.yandex/<registry-id>/telegram-gpt:<—Å—Ç–∞—Ä—ã–π-—Ç–µ–≥>
```

### –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ GitHub

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∫–æ–º–º–∏—Ç—É:

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
git log --oneline  # –ù–∞–π–¥–∏—Ç–µ —Ö–æ—Ä–æ—à–∏–π –∫–æ–º–º–∏—Ç

# –û—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –∫ –Ω–µ–º—É
git revert <bad-commit-hash>

# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
git push origin main

# –î–µ–ø–ª–æ–π –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

**–ì–æ—Ç–æ–≤–æ!** üéâ –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main` –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

üìñ **[Best Practices –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Üí](best-practices.md)**

üìñ **[–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º ‚Üí](troubleshooting.md)**

